- id: time_update
  then:
    - lambda: |-
        char time_buf[6];
        auto now = id(sntp_time).now();
        snprintf(time_buf, sizeof(time_buf), "%02d:%02d", now.hour, now.minute);

        lv_label_set_text(id(id_lv_lab_display_time), time_buf);
        lv_label_set_text(id(id_lv_lab_time_notif_area), time_buf);

    - lvgl.label.update:
        id: id_lv_lab_display_day
        text: !lambda |-
          static const char * const days_fr[] = {"Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"};
          static char date_buf[40];
          auto now = id(sntp_time).now();
          if (!now.is_valid()) {
            date_buf[0] = '\0';
            return date_buf;
          }
          int dow = now.day_of_week;
          if (dow < 1 || dow > 7) {
            dow = 1;
          }
          snprintf(date_buf, sizeof(date_buf), "%s", days_fr[dow - 1]);
          return date_buf;

    - lvgl.label.update:
        id: id_lv_lab_display_date
        text: !lambda |-
          static const char * const mon_fr[] = {"Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"};
          static char month_buf[40];
          auto now = id(sntp_time).now();
          if (!now.is_valid()) {
            month_buf[0] = '\0';
            return month_buf;
          }
          int m = now.month;
          if (m < 1 || m > 12) {
            m = 1;
          }
          snprintf(month_buf, sizeof(month_buf), "%02d %s", now.day_of_month, mon_fr[m - 1]);
          return month_buf;